10     LET A=0
20     INPUT A
30     IF A=1 GOTO 330 :  REM COIN TEST
40     IF A=2 GOTO 460 :  REM COLLECT 
50     IF A=3 GOTO 530 :  REM REFUND
60     IF A=4 GOTO 720 :  REM RESULT
70     IF A=5 GOTO 600 :  REM OPERATOR ATTACHED
80     IF A=6 GOTO 680 :  REM OPERATOR DETATCHED
90     IF A=7 GOTO 790 :  REM STUCK COIN
100    IF A=8 GOTO 900 :  REM COIN PRESENT
110    IF A=9 GOTO 1010 :  REM ON HOOK COLLECT
120    IF A=10 GOTO 1080 :  REM ON HOOK REFUND
130    IF A=99 GOTO 220 :  REM RESET
140    GOTO 10
150    REM CLEANUP ROUTINE
160    CLEAR S
170    LET X=0 :  REM SLOW THIS THING DOWN A BIT
180    DO 
190   X=X+1
200    WHILE X<250 :  REM NO SLEEP FUNCTION SO
210    IF O=1 GOTO 280 :  REM IF OPERATOR ATTACHED PRESERVE THAT
220    LET O=0 :  REM RESET OPR ATTACHED BIT
230    PUSH 0 :  REM RESET EVERYTHING TO 0
240    PUSH 201
250    CALL 25
260    CALL 54
270    GOTO 10 :  REM BACK TO THE MENU
280    PUSH 8 :  REM OPERATOR ATTACHED SO 8
290    PUSH 201
300    CALL 25
310    CALL 54
320    GOTO 10 : BACK TO THEBEGINNING
330    REM COIN TEST
340    CLEAR S
350    PUSH 1 :  REM COIN TEST IS 0001
360    PUSH 201
370    CALL 25
380    CALL 54
390    LET Y=0 :  REM WE ARE ALSO GOING TO READ OUT THE RESULT NOW SO WAIT A BI
400    DO 
410   Y=Y+1
420    WHILE Y<200
430    GOTO 720 :  REM GOTO THE RESULT ROUTINE
440    GOTO 160 :  REM GOTO THE CLEANUP ROUTINE
450    REM COLLECT
460    CLEAR S
470    PUSH 2 :  REM COLLECT IS 0010
480    PUSH 201
490    CALL 25
500    CALL 54
510    GOTO 160 :  REM GOTO THE CLEANUP ROUTINE
520    REM REFUND
530    CLEAR S
540    PUSH 4 :  REM RETURN IS 0100
550    PUSH 201
560    CALL 25
570    CALL 54
580    GOTO 160 :  REM GOTO THE CLEANUP ROUTINE
590    REM OPERATOR ATTACHED
600    CLEAR S
610    LET O=1 :  REM SET THE VAR SO THE CLEANUP ROUTINE KNOWS
620    PUSH 8 :  REM OPER ATTACHED IS 1000
630    PUSH 201
640    CALL 25
650    CALL 54
660    GOTO 160 :  REM GOTO THE CLEANUP ROUTINE
670    REM OPERATOR DETATCHED
680    CLEAR S
690    LET O=0 :  REM SET VAR TO 0 THE CLEANUP ROUTINE WILL TURN THE RELAY OFF
700    GOTO 210 :  REM GOTO THE CLEANUP ROUTINE SKIPPING THE DELAY
710    REM RESULT READOUT
720    CLEAR S
730    CALL 53
740    PUSH 201
750    CALL 15
760    POP W
770    PRINT W
780    GOTO 210 :  REM GOTO CLEANUP ROUTINE SKIPPING DELAY
790    REM stuck coin
800    CLEAR S
810    PUSH 16 :  REM stuck coin is 0001 0000
820    PUSH 201
830    CALL 25
840    CALL 54
850    LET Y=0 :  REM slow it down
860    DO 
870   Y=Y+1
880    WHILE Y<200
890    GOTO 720 :  REM TO THE RESULT ROUTINE
900    REM coin present
910    CLEAR S
920    PUSH 32 :  REM coin present is 0010 0000
930    PUSH 201
940    CALL 25
950    CALL 54
960    LET Y=0 :  REM slow it down
970    DO 
980   Y=Y+1
990    WHILE Y<200
1000   GOTO 720 :  REM TO THE RESULT ROUTINE
1010   REM ON HOOK COLLECT
1020   CLEAR S
1030   PUSH 64 :  REM ON HOOK COLLECT IS 0100 0000
1040   PUSH 201
1050   CALL 25
1060   CALL 54
1070   GOTO 160 :  REM TO THE CLEANUP ROUTINE
1080   REM ON HOOK REFUND
1090   CLEAR S
1100   PUSH 128 :  REM ON HOOK REFUND IS 1000 0000
1110   PUSH 201
1120   CALL 25
1130   CALL 54
1140   GOTO 160 :  REM TO THE CLEANUP ROUTINE


